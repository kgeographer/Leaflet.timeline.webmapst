SET search_path = getty, public;

-- replace sources drawn from _explicit dump with those from _full dump
DELETE FROM getty.sources;
-- copy getty.sources(sourceid,title,short_title) from '/Users/karlg/Documents/repos/whgaz/data/getty/sources_full.tsv' null as '';

-- compare _full and explicit
SELECT * FROM sources WHERE sourceid NOT IN (SELECT sourceid FROM sources_explicit)
-- 29, but none are referenced in TGNOut_SourceRels.nt

SELECT ts.termid, count(*) FROM term_source ts WHERE ts.sourceid IN (
2009007231,2009007784,2009008777,2009008778,2009009379,2009009380,2009009381,2009009382,2009009383,2009009384,2009009385,2009009386,2009009387,2009009388,2009009389,2009009390,2009009391,2009009392,2009009393,2009009394,2009009395,2009009396,2009009397,2009009398,2009009399,2009009400,2009009401,2009009402,2009009403)
    GROUP BY termid ORDER BY count DESC

SELECT DISTINCT ON (ps.tgnid) ps.tgnid, p.title -> 'label' AS toponym
    FROM place_source ps JOIN places p ON ps.tgnid = p.id::INTEGER
    WHERE ps.sourceid IN
    (2009007033,9006444,9006303,9006447,9006548,9005423,9006249,2009007203,9006339,9005213,9006723,9005815,9000010,9006357,9006467,9006584,9006295,9005538,9005409,9006073,9005424,9006402,9006208,9005545,9005509,9006407,9005524,9006892,9006237,9005521,9005523,9005040,9006274,9006324,9005544,9005099,9006437,9005516,9006333,9006112,9005531,9005520,9005422,9006490,9006116,9005546,9006886,9006015,9005508,9005502,9004623,9005563,9006141,9005110,9005504,9005712,9005525,9005439,9006372,9006415,9005421,9006135,2009007267,9005628,9006250,9004885,9006427,9006144,9005433,9006870,9006322,9006961,9006353,9005446,9005503,9004898,9006131,9005540,9005518,9006920,9004884,9006313,9005101,9005443,9006321,9006277,9006530,9005635,9006486,9006721,9006182,9005465,9005522,9006411,9005702,9005480,9005732,9005808,9006066,9005519,9005514,9005501,9006895,9006233,9004449,9006088,9006876,9006181,9006767,9005306,9005551,9005447,9005489,9006769,9005581,9004777,9006202,9006454,9005792,9006145,9006387,9006451,9005782,9005511,9005458,9005533,9006405,9005866,9005871,9005726,9006302,9006470,9006059,9005703,9006801,9005918,9005396,9006246,9005408,9005455,9005456,9006576,9006127,2009007078,9005708,9005786,9006337,9006747,9006445,9006067,9006453,2009007079,9005706,9006231,9006948,9005687,9006513,9006074,9006391,9006200,9000067,9005481,9006305)